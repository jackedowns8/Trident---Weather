<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <style type="text/css">
        .app h1 {
			font-family: Calibri, Calibri Bold, Calibri Bold Italic, Calibri Italic, Calibri Light;
		}
        .app h2 {
			font-family: Calibri, Calibri Bold, Calibri Bold Italic, Calibri Italic, Calibri Light;
		}
        </style>
        <title>Home</title>
    </head>

    <body>
    	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
        <script language="XML" src="http://www.geoplugin.net/javascript.gp" type="text/javascript"></script>
        <div class="app">
        	<input type="checkbox" id="drawer-toggle" name="drawer-toggle"/>
			<label for="drawer-toggle" id="drawer-toggle-label"></label>
   			<sidebarheader>Home</sidebarheader>
			<nav id="drawer">
				<h1><p><a href="index.html">Home</a></p></h1>
				<h2><p><a href="notes.html">Notes</a></p></h2>
				<h1><p><a href="about.html">About</a></p></h1>
   			</nav>
  		 	<div id="page-content">
                <div id="tides">Loading Tide...</div>
                <div id="element">Loading Location...</div>
                <div id="test"></div>
   			</div>     
        </div>
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="js/index.js"></script>
        <script type="text/javascript">
            app.initialize();
			var tideInfo = document.getElementById('tides');	
			var element = document.getElementById('element');
			var test = document.getElementById('test');
			var coordinates = "Please Wait...";
			
			// onSuccess Callback
			// This method accepts a Position object, which contains the
			// current GPS coordinates
			//
			var onSuccess = function(position) {
			  coordinates = position.coords.latitude+','+position.coords.longitude;
			  element.innerHTML = coordinates;
			  var xhr = new XMLHttpRequest();
			  xhr.open("GET", "http://api.worldweatheronline.com/premium/v1/marine.ashx?key=7256225c1f04fee7a0721a16f9a36&format=xml&q="+coordinates+"&tide=yes&fx=yes", false);
			  xhr.setRequestHeader('Content-Type', 'text/xml');
			  xhr.send();
			
			  xmlDocument = xhr.responseXML;
			  var tideType0 = xmlDocument.getElementsByTagName("tide_type")['0'].childNodes['0'].nodeValue;
			  var tideType1 = xmlDocument.getElementsByTagName("tide_type")['1'].childNodes['0'].nodeValue;
			  var tideType2 = xmlDocument.getElementsByTagName("tide_type")['2'].childNodes['0'].nodeValue;
			  var tideType3 = xmlDocument.getElementsByTagName("tide_type")['3'].childNodes['0'].nodeValue;
			  var tideTime0 = xmlDocument.getElementsByTagName("tideTime")['0'].childNodes['0'].nodeValue;
			  var tideTime1 = xmlDocument.getElementsByTagName("tideTime")['1'].childNodes['0'].nodeValue;
			  var tideTime2 = xmlDocument.getElementsByTagName("tideTime")['2'].childNodes['0'].nodeValue;
			  var tideTime3 = xmlDocument.getElementsByTagName("tideTime")['3'].childNodes['0'].nodeValue;
			  var tideHeight = xmlDocument.getElementsByTagName("tideHeight_mt")['0'].childNodes['0'].nodeValue;
			  var date = xmlDocument.getElementsByTagName("date")['0'].childNodes['0'].nodeValue;
			  
			  tideInfo.innerHTML = date + "</br>" + tideType0 + " - " + tideTime0 + "</br>" + tideType1 + " - " + tideTime1 + "</br>" + tideType2 + " - " + tideTime2 + "</br>" + tideType3 + " - " + tideTime3;
			};
			
			// onError Callback receives a PositionError object
			//
			function onError(error) {
			  alert('Error Code: '    + error.code    + '\n' +
					'Error Message: ' + error.message + '\n');
			}
			
			navigator.geolocation.getCurrentPosition(onSuccess, onError);
			
        </script>
    </body>
</html>
